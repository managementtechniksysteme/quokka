"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/serviceworker.js").then((function(){"showNotification"in ServiceWorkerRegistration.prototype&&"granted"===Notification.permission&&"PushManager"in window&&navigator.serviceWorker.ready.then((function(n){n.pushManager.getSubscription().then((function(n){var e,t,o,i,r,a;n&&(e=n,t=document.querySelector("meta[name=csrf-token]").getAttribute("content"),o=e.getKey("p256dh"),i=e.getKey("auth"),r=(PushManager.supportedContentEncodings||["aesgcm"])[0],a={endpoint:e.endpoint,public_key:o?btoa(String.fromCharCode.apply(null,new Uint8Array(o))):null,auth_token:i?btoa(String.fromCharCode.apply(null,new Uint8Array(i))):null,content_encoding:r},fetch("/webpush",{method:"POST",body:JSON.stringify(a),headers:{Accept:"application/json","Content-Type":"application/json","X-CSRF-Token":t}}).then((function(n){return n.json()})).catch((function(n){console.log(n)})))})).catch((function(n){console.log(n)}))}))}))}));